<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Reset de Usuários - Suporte Infra CDs</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --magalu-blue: #0086FF;
            --magalu-blue-dark: #0066CC;
            --magalu-blue-darker: #004499;
            --magalu-pink: #E91E76;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }

        .fade-enter-active,
        .fade-leave-active {
            transition: opacity 0.3s ease;
        }

        .fade-enter-from,
        .fade-leave-to {
            opacity: 0;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        /* Rainbow Strip - Magalu Colors */
        .rainbow-strip {
            height: 4px;
            background: linear-gradient(90deg,
                    #E91E76 0%,
                    #FF5722 16%,
                    #FF9800 32%,
                    #4CAF50 48%,
                    #2196F3 64%,
                    #9C27B0 80%,
                    #E91E76 100%);
            background-size: 200% 100%;
            animation: rainbow-flow 8s linear infinite;
        }

        @keyframes rainbow-flow {
            0% {
                background-position: 0% 50%;
            }

            100% {
                background-position: 200% 50%;
            }
        }

        /* Gradient Header */
        .header-gradient {
            background: linear-gradient(135deg, var(--magalu-blue-darker) 0%, var(--magalu-blue-dark) 50%, var(--magalu-blue) 100%);
        }

        /* Card Hover Effects */
        .card-hover {
            transition: all 0.2s ease;
        }

        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.1);
        }

        /* Status Badges - Enhanced */
        .badge-pending {
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            color: #92400E;
            border: 1px solid #F59E0B;
        }

        .badge-success {
            background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%);
            color: #065F46;
            border: 1px solid #10B981;
        }

        .badge-error {
            background: linear-gradient(135deg, #FEE2E2 0%, #FECACA 100%);
            color: #991B1B;
            border: 1px solid #EF4444;
        }

        /* Button Primary - Magalu Style */
        .btn-magalu {
            background: linear-gradient(135deg, var(--magalu-blue) 0%, var(--magalu-blue-dark) 100%);
            transition: all 0.2s ease;
        }

        .btn-magalu:hover {
            background: linear-gradient(135deg, var(--magalu-blue-dark) 0%, var(--magalu-blue-darker) 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 134, 255, 0.4);
        }

        /* Input Focus - Enhanced */
        input:focus,
        select:focus {
            border-color: var(--magalu-blue) !important;
            box-shadow: 0 0 0 3px rgba(0, 134, 255, 0.15) !important;
        }

        /* Table Row Hover */
        .table-row-hover:hover {
            background-color: #EFF6FF !important;
        }

        /* Avatar Glow */
        .avatar-glow {
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
        }
    </style>
</head>

<body class="h-screen flex flex-col overflow-hidden">

    <div id="app" class="flex flex-col h-full">

        <div v-if="currentView === 'login'"
            class="flex min-h-full items-center justify-center py-12 px-4 sm:px-6 lg:px-8 h-full"
            style="background: linear-gradient(135deg, #004499 0%, #0066CC 50%, #0086FF 100%);">

            <!-- Rainbow Strip no topo -->
            <div class="rainbow-strip fixed top-0 left-0 right-0"></div>

            <div
                class="w-full max-w-md space-y-8 bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/20">
                <div class="text-center flex flex-col items-center">
                    <div class="bg-gradient-to-br from-blue-500 to-blue-700 p-4 rounded-2xl shadow-lg mb-4">
                        <svg class="h-10 w-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z">
                            </path>
                        </svg>
                    </div>
                    <h2 class="mt-2 text-3xl font-bold tracking-tight text-gray-900">AD Reset Tool</h2>
                    <p class="text-sm font-medium text-blue-600">Suporte Infra CDs</p>
                    <p class="mt-2 text-sm text-gray-500">
                        Faça login para acessar a ferramenta
                    </p>
                </div>
                <form class="mt-8 space-y-6" @submit.prevent="handleLogin">
                    <div class="-space-y-px rounded-md shadow-sm">
                        <div>
                            <label for="email-address" class="sr-only">Email</label>
                            <input id="email-address" name="email" type="email" autocomplete="email" required
                                v-model="authForm.email"
                                class="relative block w-full appearance-none rounded-t-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:z-10 focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"
                                placeholder="Email corporativo">
                        </div>
                        <div>
                            <label for="password" class="sr-only">Senha</label>
                            <input id="password" name="password" type="password" autocomplete="current-password"
                                required v-model="authForm.password"
                                class="relative block w-full appearance-none rounded-b-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:z-10 focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"
                                placeholder="Senha">
                        </div>
                    </div>

                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <input id="remember-me" name="remember-me" type="checkbox" v-model="rememberMe"
                                class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                            <label for="remember-me" class="ml-2 block text-sm text-gray-900">Lembrar-me</label>
                        </div>
                        <div class="text-sm">
                            <a href="#" @click.prevent="currentView = 'forgot_password'"
                                class="font-medium text-blue-600 hover:text-blue-500">Esqueci minha senha</a>
                        </div>
                    </div>

                    <div>
                        <button type="submit" :disabled="isLoading"
                            class="btn-magalu group relative flex w-full justify-center rounded-lg border border-transparent py-3 px-4 text-sm font-semibold text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50">
                            {{ isLoading ? 'Entrando...' : 'Entrar' }}
                        </button>
                    </div>
                </form>
                <div class="text-center space-y-2">
                    <p class="text-sm text-gray-600">
                        Não tem acesso?
                        <a href="#" @click.prevent="currentView = 'register'"
                            class="font-medium text-blue-600 hover:text-blue-500">Solicitar Acesso</a>
                    </p>
                </div>
                <!-- Versão no canto inferior -->
                <div class="text-center text-xs text-gray-400 pt-4 border-t border-gray-100">
                    v1.0.5 • Leandro Araújo
                </div>
            </div>
        </div>

        <div v-if="currentView === 'register'"
            class="flex min-h-full items-center justify-center py-12 px-4 sm:px-6 lg:px-8 h-full"
            style="background: linear-gradient(135deg, #004499 0%, #0066CC 50%, #0086FF 100%);">

            <!-- Rainbow Strip no topo -->
            <div class="rainbow-strip fixed top-0 left-0 right-0"></div>

            <div
                class="w-full max-w-md space-y-8 bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/20">
                <div class="text-center flex flex-col items-center">
                    <div class="bg-gradient-to-br from-green-500 to-green-700 p-4 rounded-2xl shadow-lg mb-4">
                        <svg class="h-10 w-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z">
                            </path>
                        </svg>
                    </div>
                    <h2 class="mt-2 text-3xl font-bold tracking-tight text-gray-900">Solicitar Acesso</h2>
                    <p class="mt-2 text-sm text-gray-500">Informe seu ID Magalu para localizar seu cadastro.</p>
                </div>
                <form class="mt-8 space-y-6" @submit.prevent="handleRegister">
                    <div class="shadow-sm space-y-4">
                        <div>
                            <label for="reg-id" class="sr-only">ID Magalu</label>
                            <div class="flex">
                                <input id="reg-id" name="id" type="text" required v-model="authForm.id"
                                    class="relative block w-full rounded-l-lg border border-gray-300 px-3 py-2.5 text-gray-900 placeholder-gray-500 focus:z-10 focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"
                                    placeholder="ID Magalu (Números)" @blur="fetchUserData" :disabled="isLoading">
                                <button type="button" @click="fetchUserData" :disabled="isLoading"
                                    class="relative -ml-px inline-flex items-center space-x-2 rounded-r-lg border border-gray-300 bg-gray-100 px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-200 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                    </svg>
                                    <span>Buscar</span>
                                </button>
                            </div>
                        </div>

                        <div v-if="authForm.name"
                            class="bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-lg border border-green-200 animate-fade-in">
                            <div class="flex items-center">
                                <div class="bg-green-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M5 13l4 4L19 7"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-xs text-green-600 uppercase font-bold">Colaborador Encontrado</p>
                                    <p class="text-sm font-semibold text-gray-900">{{ authForm.name }}</p>
                                    <p class="text-xs text-gray-600">{{ authForm.email }}</p>
                                </div>
                            </div>
                        </div>
                        <div v-if="authForm.errorMessage"
                            class="bg-red-50 text-red-600 text-sm text-center p-3 rounded-lg border border-red-200">
                            {{ authForm.errorMessage }}
                        </div>
                    </div>

                    <div>
                        <button type="submit" :disabled="isLoading || !authForm.name"
                            class="group relative flex w-full justify-center rounded-lg border border-transparent py-3 px-4 text-sm font-semibold text-white focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all"
                            style="background: linear-gradient(135deg, #10B981 0%, #059669 100%);">
                            {{ isLoading ? 'Enviando...' : 'Solicitar Acesso' }}
                        </button>
                    </div>
                </form>
                <div class="text-center pt-4 border-t border-gray-100">
                    <a href="#" @click.prevent="currentView = 'login'"
                        class="font-medium text-blue-600 hover:text-blue-500 flex items-center justify-center">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        Voltar para Login
                    </a>
                </div>
            </div>
        </div>

        <div v-if="currentView === 'change_password'"
            class="flex min-h-full items-center justify-center py-12 px-4 sm:px-6 lg:px-8 h-full"
            style="background: linear-gradient(135deg, #004499 0%, #0066CC 50%, #0086FF 100%);">

            <!-- Rainbow Strip no topo -->
            <div class="rainbow-strip fixed top-0 left-0 right-0"></div>

            <div
                class="w-full max-w-md space-y-8 bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/20">
                <div class="text-center flex flex-col items-center">
                    <div class="bg-gradient-to-br from-blue-500 to-blue-700 p-4 rounded-2xl shadow-lg mb-4">
                        <svg class="h-10 w-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z">
                            </path>
                        </svg>
                    </div>
                    <h2 class="mt-2 text-3xl font-bold tracking-tight text-gray-900">Primeiro Acesso</h2>
                    <p class="mt-2 text-sm text-gray-500">Por segurança, defina sua nova senha.</p>
                </div>
                <form class="mt-8 space-y-6" @submit.prevent="handleChangePassword">
                    <div class="-space-y-px rounded-md shadow-sm">
                        <div>
                            <label for="new-password" class="sr-only">Nova Senha</label>
                            <input id="new-password" name="new-password" type="password" required
                                v-model="authForm.newPassword"
                                class="relative block w-full appearance-none rounded-t-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:z-10 focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"
                                placeholder="Nova Senha">
                        </div>
                        <div>
                            <label for="confirm-password" class="sr-only">Confirmar Senha</label>
                            <input id="confirm-password" name="confirm-password" type="password" required
                                v-model="authForm.confirmPassword"
                                class="relative block w-full appearance-none rounded-b-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:z-10 focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"
                                placeholder="Confirmar Nova Senha">
                        </div>
                    </div>
                    <p v-if="authForm.errorMessage" class="text-red-500 text-sm text-center">{{ authForm.errorMessage }}
                    </p>

                    <div>
                        <button type="submit" :disabled="isLoading"
                            class="btn-magalu group relative flex w-full justify-center rounded-lg border border-transparent py-3 px-4 text-sm font-semibold text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50">
                            {{ isLoading ? 'Salvando...' : 'Definir Senha' }}
                        </button>
                    </div>
                </form>
                <div class="text-center pt-4 border-t border-gray-100">
                    <a href="#" @click.prevent="currentView = 'app'"
                        class="font-medium text-blue-600 hover:text-blue-500 flex items-center justify-center">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        Voltar para a Aplicação
                    </a>
                </div>
            </div>
        </div>

        <!-- View Esqueci Senha -->
        <div v-if="currentView === 'forgot_password'"
            class="flex min-h-full items-center justify-center py-12 px-4 sm:px-6 lg:px-8 h-full"
            style="background: linear-gradient(135deg, #004499 0%, #0066CC 50%, #0086FF 100%);">

            <!-- Rainbow Strip no topo -->
            <div class="rainbow-strip fixed top-0 left-0 right-0"></div>

            <div
                class="w-full max-w-md space-y-8 bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/20">
                <div class="text-center flex flex-col items-center">
                    <div class="bg-gradient-to-br from-amber-500 to-orange-600 p-4 rounded-2xl shadow-lg mb-4">
                        <svg class="h-10 w-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z">
                            </path>
                        </svg>
                    </div>
                    <h2 class="mt-2 text-3xl font-bold tracking-tight text-gray-900">Recuperar Senha</h2>
                    <p class="mt-2 text-sm text-gray-500">
                        Informe seu email corporativo para receber as instruções de recuperação.
                    </p>
                </div>
                <form class="mt-8 space-y-6" @submit.prevent="handleForgotPassword">
                    <div class="rounded-lg shadow-sm">
                        <div>
                            <label for="forgot-email" class="sr-only">Email</label>
                            <input id="forgot-email" name="email" type="email" autocomplete="email" required
                                v-model="authForm.email"
                                class="relative block w-full appearance-none rounded-lg border border-gray-300 px-3 py-2.5 text-gray-900 placeholder-gray-500 focus:z-10 focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"
                                placeholder="Email corporativo">
                        </div>
                    </div>
                    <div>
                        <button type="submit" :disabled="isLoading"
                            class="group relative flex w-full justify-center rounded-lg border border-transparent py-3 px-4 text-sm font-semibold text-white focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 disabled:opacity-50 transition-all"
                            style="background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);">
                            {{ isLoading ? 'Enviando...' : 'Enviar Instruções' }}
                        </button>
                    </div>
                </form>
                <div class="text-center pt-4 border-t border-gray-100">
                    <a href="#" @click.prevent="currentView = 'login'"
                        class="font-medium text-blue-600 hover:text-blue-500 flex items-center justify-center">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        Voltar para Login
                    </a>
                </div>
            </div>
        </div>

        <div v-if="currentView === 'app'" class="flex flex-col h-full">

            <header class="header-gradient text-white shadow-lg z-10">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
                    <div class="flex items-center space-x-8">
                        <div class="flex items-center space-x-3 cursor-pointer hover:opacity-80 transition-opacity"
                            @click="currentTab = 'new'">
                            <div class="bg-white/20 p-2 rounded-lg backdrop-blur-sm">
                                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z">
                                    </path>
                                </svg>
                            </div>
                            <span class="font-bold text-xl tracking-tight leading-none">
                                AD Reset Tool
                                <span
                                    class="ml-2 text-xs bg-white/20 backdrop-blur-sm px-2 py-0.5 rounded-full">v1.0.5</span>
                                <br>
                                <span class="text-xs font-normal text-blue-200/80">Suporte Infra CDs</span>
                            </span>
                        </div>
                        <div class="hidden md:flex space-x-1 bg-white/10 rounded-lg p-1">
                            <button @click="currentTab = 'new'"
                                :class="{'bg-white text-blue-700 shadow-sm': currentTab === 'new', 'text-white/80 hover:text-white hover:bg-white/10': currentTab !== 'new'}"
                                class="px-4 py-2 rounded-md text-sm font-medium transition-all">
                                <span class="flex items-center">
                                    <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 4v16m8-8H4"></path>
                                    </svg>
                                    Nova Solicitação
                                </span>
                            </button>
                            <button @click="loadQueue"
                                :class="{'bg-white text-blue-700 shadow-sm': currentTab === 'queue', 'text-white/80 hover:text-white hover:bg-white/10': currentTab !== 'queue'}"
                                class="px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center">
                                <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
                                </svg>
                                Fila de Acompanhamento
                            </button>
                            <button @click="currentTab = 'mirror'"
                                :class="{'bg-white text-blue-700 shadow-sm': currentTab === 'mirror', 'text-white/80 hover:text-white hover:bg-white/10': currentTab !== 'mirror'}"
                                class="px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center">
                                <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                                </svg>
                                Espelho de Acesso
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button @click="initiateChangePassword" title="Trocar Senha"
                            class="text-white/70 hover:text-white hover:bg-white/10 p-2 rounded-lg transition-all">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z">
                                </path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                        </button>
                        <div class="text-right hidden sm:block">
                            <div class="text-sm font-medium">{{ userEmail }}</div>
                            <div class="text-xs text-white/60">Gestor Logado</div>
                        </div>
                        <div class="h-10 w-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center text-sm font-bold avatar-glow cursor-pointer hover:bg-white/30 transition-all"
                            @click="logout" title="Sair">
                            {{ userInitials }}
                        </div>
                    </div>
                </div>
            </header>
            <!-- Rainbow Strip -->
            <div class="rainbow-strip"></div>

            <main class="flex-1 overflow-auto p-4 sm:p-6 lg:p-8">
                <div class="max-w-7xl mx-auto space-y-6">

                    <!-- ESPELHO DE ACESSO TAB -->
                    <div v-if="currentTab === 'mirror'" class="space-y-6">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <h2 class="text-lg font-medium text-gray-900 mb-4">Solicitar Espelho de Acesso (AD)</h2>
                            <p class="text-sm text-gray-500 mb-6">Digite o <b>ID de Rede (User Name)</b> do usuário
                                modelo para listar seus grupos atuais.</p>

                            <div class="flex gap-4 items-end">
                                <div class="flex-1 max-w-md">
                                    <label
                                        class="block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1">Usuário
                                        Modelo (ID de Rede)</label>
                                    <input type="text" v-model="mirrorForm.modelUser" @keyup.enter="fetchMirrorGroups"
                                        placeholder="Ex: leandro.araujo"
                                        class="block w-full px-3 py-2.5 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-lg border bg-white">
                                </div>
                                <button @click="fetchMirrorGroups" :disabled="mirrorLoading || !mirrorForm.modelUser"
                                    class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 flex items-center">
                                    <svg v-if="mirrorLoading" class="animate-spin -ml-1 mr-2 h-4 w-4 text-white"
                                        fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                            stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor"
                                            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                        </path>
                                    </svg>
                                    {{ mirrorLoading ? 'Buscando no AD...' : 'Listar Grupos' }}
                                </button>
                            </div>
                            <div v-if="mirrorStatusMsg" class="mt-2 text-sm text-orange-600 font-medium animate-pulse">
                                {{ mirrorStatusMsg }}</div>
                        </div>

                        <!-- RESULTADOS GRUPOS -->
                        <div v-if="mirrorGroups.length > 0"
                            class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-md font-bold text-gray-800">Grupos Encontrados ({{ mirrorGroups.length
                                    }})</h3>
                                <div class="text-sm text-gray-500 space-x-2">
                                    <button @click="selectAllGroups(true)" class="text-blue-600 hover:underline">Marcar
                                        Todos</button>
                                    <span>|</span>
                                    <button @click="selectAllGroups(false)"
                                        class="text-blue-600 hover:underline">Desmarcar Todos</button>
                                </div>
                            </div>

                            <div
                                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 max-h-[400px] overflow-y-auto p-2 border border-gray-100 rounded-lg bg-gray-50">
                                <label v-for="grp in mirrorGroups" :key="grp.name"
                                    class="flex items-start space-x-3 p-2 hover:bg-white rounded border border-transparent hover:border-gray-200 transition-all cursor-pointer">
                                    <input type="checkbox" v-model="grp.selected"
                                        class="mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500 h-4 w-4">
                                    <span class="text-sm text-gray-700 break-all">{{ grp.name }}</span>
                                </label>
                            </div>

                            <div class="mt-6 pt-4 border-t border-gray-100 flex justify-end items-center space-x-4">
                                <div class="text-sm text-gray-500">
                                    <span class="font-bold text-blue-600">{{ selectedGroupsCount }}</span> grupos
                                    selecionados.
                                </div>
                                <button @click="submitMirrorFinal" :disabled="selectedGroupsCount === 0"
                                    class="bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all">
                                    Solicitar Espelhamento
                                </button>
                            </div>
                        </div>
                    </div>

                    <div v-if="currentTab === 'new'" class="space-y-6">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div class="md:col-span-1">
                                    <label
                                        class="block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1">Filial
                                        / Base</label>
                                    <div class="relative">
                                        <input type="text" v-model="selectedFilial"
                                            placeholder="Digite sua filial Magalog"
                                            class="block w-full px-3 py-2.5 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-lg border bg-white"
                                            @keyup.enter="performSearch">
                                    </div>
                                </div>
                                <div class="md:col-span-3">
                                    <label
                                        class="block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1">Buscar
                                        Colaborador</label>
                                    <div class="relative rounded-md shadow-sm">
                                        <div
                                            class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24"
                                                stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                            </svg>
                                        </div>
                                        <input type="text" v-model="searchQuery" @keyup.enter="performSearch"
                                            placeholder="Nome, ID, Usuário de Rede ou Email..."
                                            class="focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-lg p-2.5 border bg-white">
                                        <div class="absolute inset-y-0 right-0 pr-2 flex items-center">
                                            <button @click="performSearch" :disabled="loading"
                                                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-1.5 rounded-md text-sm font-medium transition-colors disabled:opacity-50">{{
                                                loading ? 'Buscando...' : 'Buscar' }}</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div v-if="hasResults" class="flex flex-wrap items-center justify-between gap-4 pb-2">
                            <div class="flex items-center space-x-2">
                                <div class="text-xs font-bold text-gray-500 uppercase">Filtrar por Centro de Custo:
                                </div>
                                <select v-model="selectedCostCenter"
                                    class="text-xs border-gray-300 rounded-md border p-1.5 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm min-w-[200px]">
                                    <option value="">TODOS</option>
                                    <option v-for="cc in uniqueCostCenters" :key="cc" :value="cc">{{ cc }}</option>
                                </select>
                            </div>
                            <div class="text-xs text-gray-400">Exibindo {{ filteredResults.length }} de {{
                                searchResults.length }} encontrados</div>
                        </div>

                        <div
                            class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden min-h-[400px] flex flex-col">
                            <div v-if="!hasResults && !loading"
                                class="flex-1 flex flex-col items-center justify-center p-10 text-center text-gray-400">
                                <svg class="h-16 w-16 mb-4 text-gray-200" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1"
                                        d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                                </svg>
                                <p v-if="hasSearched">Nenhum colaborador encontrado.</p>
                                <p v-else>Use os filtros acima para encontrar colaboradores.</p>
                            </div>

                            <div v-if="hasResults" class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th scope="col"
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-10">
                                                <input type="checkbox" @change="toggleAll" :checked="allSelected"
                                                    class="rounded border-gray-300 text-blue-600 focus:ring-blue-500 h-4 w-4">
                                            </th>
                                            <th scope="col" @click="sortResults('id')"
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                                ID
                                                <span v-if="resultSortColumn === 'id'" class="ml-1">{{
                                                    resultSortDirection === 'asc' ? '↑' : '↓' }}</span>
                                            </th>
                                            <th scope="col" @click="sortResults('nome')"
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                                Nome / Cargo
                                                <span v-if="resultSortColumn === 'nome'" class="ml-1">{{
                                                    resultSortDirection === 'asc' ? '↑' : '↓' }}</span>
                                            </th>
                                            <th scope="col" @click="sortResults('user_name')"
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                                Usuário Rede
                                                <span v-if="resultSortColumn === 'user_name'" class="ml-1">{{
                                                    resultSortDirection === 'asc' ? '↑' : '↓' }}</span>
                                            </th>
                                            <th scope="col" @click="sortResults('email')"
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                                Email
                                                <span v-if="resultSortColumn === 'email'" class="ml-1">{{
                                                    resultSortDirection === 'asc' ? '↑' : '↓' }}</span>
                                            </th>
                                            <th scope="col" @click="sortResults('centro_custo')"
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                                Centro de Custo
                                                <span v-if="resultSortColumn === 'centro_custo'" class="ml-1">{{
                                                    resultSortDirection === 'asc' ? '↑' : '↓' }}</span>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200">
                                        <tr v-for="user in filteredResults" :key="user.user_name"
                                            :class="{'bg-blue-50': user.selected, 'hover:bg-gray-50': !user.selected}"
                                            class="transition-colors text-xs">
                                            <td class="px-4 py-3 whitespace-nowrap"><input type="checkbox"
                                                    v-model="user.selected"
                                                    class="rounded border-gray-300 text-blue-600 focus:ring-blue-500 h-4 w-4">
                                            </td>
                                            <td class="px-4 py-3 whitespace-nowrap">
                                                <span class="text-xs font-mono bg-gray-100 px-2 py-0.5 rounded">{{
                                                    user.id || '-' }}</span>
                                            </td>
                                            <td class="px-4 py-3 whitespace-nowrap">
                                                <div class="flex items-center">
                                                    <div>
                                                        <div class="font-medium text-gray-900">{{ toTitleCase(user.nome)
                                                            }}</div>
                                                        <div class="text-[10px] text-gray-500">{{
                                                            toTitleCase(user.cargo) }}</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="px-4 py-3 whitespace-nowrap">
                                                <div
                                                    class="text-xs text-gray-900 font-mono bg-gray-100 px-2 py-0.5 rounded inline-block">
                                                    {{ user.user_name }}</div>
                                                <span v-if="user.ja_resetado"
                                                    class="ml-2 inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-yellow-100 text-yellow-800">Já
                                                    Resetado</span>
                                            </td>
                                            <td class="px-4 py-3 whitespace-nowrap text-xs text-gray-500">{{ user.email
                                                ? user.email.toLowerCase() : '-' }}</td>
                                            <td class="px-4 py-3 whitespace-nowrap text-xs text-gray-500">{{
                                                user.centro_custo }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div v-if="currentTab === 'queue'"
                        class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                        <div class="p-6 border-b border-gray-200 flex justify-between items-center bg-gray-50">
                            <h2 class="text-lg font-medium text-gray-900">Últimas Solicitações</h2>
                            <button @click="loadQueue"
                                class="text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center">
                                <svg class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                </svg>
                                Atualizar
                            </button>
                        </div>

                        <!-- Filtros da Fila -->
                        <div class="p-4 bg-gray-50 border-b border-gray-200">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <label
                                        class="block text-xs font-semibold text-gray-500 uppercase mb-1">Filial</label>
                                    <select v-model="queueFilters.filial"
                                        class="w-full text-sm border-gray-300 rounded-md border p-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
                                        <option value="">Todas as Filiais</option>
                                        <option v-for="filial in uniqueQueueFilials" :key="filial" :value="filial">{{
                                            filial }}</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        class="block text-xs font-semibold text-gray-500 uppercase mb-1">Status</label>
                                    <select v-model="queueFilters.status"
                                        class="w-full text-sm border-gray-300 rounded-md border p-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
                                        <option value="">Todos os Status</option>
                                        <option value="PENDENTE">PENDENTE</option>
                                        <option value="SUCESSO">SUCESSO</option>
                                        <option value="ERRO">ERRO</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        class="block text-xs font-semibold text-gray-500 uppercase mb-1">Analista</label>
                                    <select v-model="queueFilters.analista"
                                        class="w-full text-sm border-gray-300 rounded-md border p-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
                                        <option value="">Todos os Analistas</option>
                                        <option v-for="analista in uniqueQueueAnalysts" :key="analista"
                                            :value="analista">{{ analista }}</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        class="block text-xs font-semibold text-gray-500 uppercase mb-1">Buscar</label>
                                    <input type="text" v-model="queueFilters.search" placeholder="Nome ou usuário..."
                                        class="w-full text-sm border-gray-300 rounded-md border p-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
                                </div>
                            </div>
                        </div>

                        <div v-if="queueLoading" class="p-10 text-center text-gray-400">Carregando fila...</div>
                        <div v-else class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th @click="sortQueue('id')"
                                            class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 w-16">
                                            ID
                                            <span v-if="sortColumn === 'id'" class="ml-1">{{ sortDirection === 'asc' ?
                                                '↑' : '↓' }}</span>
                                        </th>
                                        <th @click="sortQueue('data')"
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100">
                                            Data
                                            <span v-if="sortColumn === 'data'" class="ml-1">{{ sortDirection === 'asc' ?
                                                '↑' : '↓' }}</span>
                                        </th>
                                        <th @click="sortQueue('filial')"
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100">
                                            Filial
                                            <span v-if="sortColumn === 'filial'" class="ml-1">{{ sortDirection === 'asc'
                                                ? '↑' : '↓' }}</span>
                                        </th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Usuário</th>
                                        <th @click="sortQueue('analista')"
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100">
                                            Analista
                                            <span v-if="sortColumn === 'analista'" class="ml-1">{{ sortDirection ===
                                                'asc' ? '↑' : '↓' }}</span>
                                        </th>
                                        <th @click="sortQueue('status')"
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100">
                                            Status
                                            <span v-if="sortColumn === 'status'" class="ml-1">{{ sortDirection === 'asc'
                                                ? '↑' : '↓' }}</span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <tr v-for="item in paginatedQueue" :key="item.id || (item.data + item.user)"
                                        class="hover:bg-gray-50">
                                        <td
                                            class="px-4 py-4 whitespace-nowrap text-sm font-mono text-gray-600 bg-gray-50">
                                            #{{ item.id || '-' }}
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{
                                            formatDate(item.data) }}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ item.filial }}
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="text-sm font-medium text-gray-900">{{ toTitleCase(item.nome) }}
                                            </div>
                                            <div class="text-xs text-gray-500">{{ item.user }}</div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ item.analista
                                            }}</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span
                                                :class="{'bg-yellow-100 text-yellow-800': item.status === 'PENDENTE', 'bg-green-100 text-green-800': item.status === 'SUCESSO', 'bg-red-100 text-red-800': item.status === 'ERRO'}"
                                                class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">{{
                                                item.status }}</span>
                                        </td>
                                    </tr>
                                    <tr v-if="paginatedQueue.length === 0">
                                        <td colspan="6" class="px-6 py-10 text-center text-gray-400">Nenhum registro
                                            encontrado com os filtros selecionados.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Paginação -->
                        <div v-if="!queueLoading && filteredQueue.length > 0"
                            class="p-4 bg-gray-50 border-t border-gray-200 flex flex-col sm:flex-row justify-between items-center gap-4">
                            <div class="flex items-center space-x-2">
                                <span class="text-sm text-gray-600">Registros por página:</span>
                                <select v-model="itemsPerPage" @change="currentPage = 1"
                                    class="text-sm border-gray-300 rounded-md border p-1.5 focus:ring-blue-500 focus:border-blue-500 bg-white">
                                    <option :value="10">10</option>
                                    <option :value="25">25</option>
                                    <option :value="50">50</option>
                                    <option :value="100">100</option>
                                </select>
                                <span class="text-sm text-gray-500 ml-4">{{ filteredQueue.length }} registros</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <button @click="changePage(currentPage - 1)" :disabled="currentPage === 1"
                                    class="px-3 py-1.5 text-sm font-medium rounded-md border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
                                    Anterior
                                </button>
                                <span class="text-sm text-gray-600">
                                    Página {{ currentPage }} de {{ totalPages }}
                                </span>
                                <button @click="changePage(currentPage + 1)"
                                    :disabled="currentPage === totalPages || totalPages === 0"
                                    class="px-3 py-1.5 text-sm font-medium rounded-md border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
                                    Próxima
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <footer v-if="currentTab === 'new'" class="bg-white border-t border-gray-200 p-4 shadow-lg-up z-20">
                <div class="max-w-7xl mx-auto flex items-center justify-between">
                    <div class="text-sm text-gray-500">
                        <span v-if="selectedCount > 0" class="font-bold text-blue-600">{{ selectedCount }}</span>
                        colaborador(es) selecionado(s).
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="hidden sm:block">
                            <label class="text-xs font-semibold text-gray-500 mr-2 uppercase">Analista
                                Responsável:</label>
                            <select v-model="selectedAnalyst"
                                class="text-sm border-gray-300 rounded-md border p-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50">
                                <option value="" disabled>Selecione quem irá atender...</option>
                                <option v-for="a in analystList" :key="a" :value="a">{{ a }}</option>
                            </select>
                        </div>
                        <button @click="openConfirmModal"
                            :disabled="selectedCount === 0 || submitting || !selectedAnalyst"
                            class="bg-green-600 hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all flex items-center">
                            {{ submitting ? 'Enviando...' : 'SOLICITAR RESET' }}
                        </button>
                    </div>
                </div>
            </footer>

            <div class="bg-gray-100 text-center py-2 text-xs text-gray-400 border-t border-gray-200">
                Leandro Araújo - Suporte Infra CDs
            </div>

            <div v-show="isConfirmModalVisible" style="display: none;" class="fixed inset-0 z-50 overflow-y-auto">
                <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
                    <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>
                    <div
                        class="inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6">
                        <h3 class="text-lg leading-6 font-medium text-gray-900">Confirmação</h3>
                        <div class="mt-4 text-left bg-gray-50 p-4 rounded-md border border-gray-200">
                            <p class="text-sm text-gray-600 mb-2">Solicitando reset para:</p>
                            <p class="text-2xl font-bold text-gray-900">{{ selectedCount }} colaboradores</p>
                            <p class="mt-2 text-sm text-gray-600">Analista: <b>{{ selectedAnalyst }}</b></p>
                        </div>
                        <div class="mt-5 sm:mt-6 flex flex-col-reverse sm:flex-row sm:gap-3">
                            <button @click="isConfirmModalVisible = false"
                                class="mt-3 sm:mt-0 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 sm:text-sm">Cancelar</button>
                            <button @click="confirmAndSend"
                                class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 sm:text-sm">Confirmar</button>
                        </div>
                    </div>
                </div>
            </div>

            <div v-show="isSuccessModalVisible" style="display: none;" class="fixed inset-0 z-50 overflow-y-auto">
                <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
                    <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>
                    <div
                        class="inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-sm sm:w-full sm:p-6">
                        <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100">
                            <svg class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 13l4 4L19 7" />
                            </svg>
                        </div>
                        <div class="mt-3 text-center sm:mt-5">
                            <h3 class="text-lg leading-6 font-medium text-gray-900">Solicitação Enviada!</h3>
                            <button @click="downloadReceipt"
                                class="mt-4 w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-blue-700 bg-blue-100 hover:bg-blue-200">Baixar
                                Comprovante</button>
                        </div>
                        <div class="mt-5 sm:mt-6">
                            <button @click="resetForm"
                                class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-gray-600 text-base font-medium text-white hover:bg-gray-700 sm:text-sm">Fechar</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;

        createApp({
            setup() {
                // ==========================================
                // CONFIGURAÇÃO DA LOGO
                // ==========================================
                // Cole o código Base64 da sua imagem (sem fundo) entre as aspas abaixo:
                const appLogo = "data:image/png;base64,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";
                // Exemplo: "data:image/png;base64,iVBORw0K..."

                // Auth State
                const currentView = ref('login');
                const isLoading = ref(false);
                const authForm = ref({ id: '', email: '', password: '', name: '', newPassword: '', confirmPassword: '', errorMessage: '' });
                const userEmail = ref('');
                const userInitials = ref('');

                // App State
                const currentTab = ref('new');
                const filiais = ref([]);
                const analystList = ref([]);
                const selectedFilial = ref('');
                const selectedAnalyst = ref('');
                const searchQuery = ref('');
                const searchResults = ref([]);
                const loading = ref(false);
                const submitting = ref(false);
                const isSuccessModalVisible = ref(false);
                const isConfirmModalVisible = ref(false);
                const lastRequestData = ref(null);
                const queueData = ref([]);
                const queueLoading = ref(false);
                const selectedCostCenter = ref('');

                // Mirror State
                const mirrorForm = ref({ modelUser: '' });
                const mirrorGroups = ref([]);
                const mirrorLoading = ref(false);
                const mirrorStatusMsg = ref('');
                const mirrorPollInterval = ref(null);

                // Estados para filtros e paginação da fila
                const queueFilters = ref({ filial: '', status: '', analista: '', search: '' });
                const currentPage = ref(1);
                const itemsPerPage = ref(25);
                const sortColumn = ref('data');
                const sortDirection = ref('desc');

                // Estados para ordenação dos resultados de busca
                const resultSortColumn = ref('nome');
                const resultSortDirection = ref('asc');

                const rememberMe = ref(false);

                // --- AUTH METHODS ---
                const handleLogin = () => {
                    isLoading.value = true;
                    google.script.run.withSuccessHandler(res => {
                        isLoading.value = false;
                        if (res.success) {
                            // Salva ou Limpa credenciais
                            if (rememberMe.value) {
                                localStorage.setItem('savedEmail', authForm.value.email);
                                localStorage.setItem('savedPassword', authForm.value.password); // Nota: Em produção real, evitar salvar senhas em plain text
                                localStorage.setItem('rememberMe', 'true');
                            } else {
                                localStorage.removeItem('savedEmail');
                                localStorage.removeItem('savedPassword');
                                localStorage.removeItem('rememberMe');
                            }

                            userEmail.value = res.token;
                            userInitials.value = res.name.substring(0, 2).toUpperCase();
                            if (res.firstAccess) {
                                currentView.value = 'change_password';
                            } else {
                                initApp();
                            }
                        }
                    }).withFailureHandler(err => {
                        isLoading.value = false;
                        alert(err.message);
                    }).login(authForm.value.email, authForm.value.password);
                };

                // Auto-load credentials
                onMounted(() => {
                    if (localStorage.getItem('rememberMe') === 'true') {
                        authForm.value.email = localStorage.getItem('savedEmail') || '';
                        authForm.value.password = localStorage.getItem('savedPassword') || '';
                        rememberMe.value = true;
                    }
                });

                // Esqueci Senha
                const handleForgotPassword = () => {
                    if (!authForm.value.email) {
                        alert('Por favor, informe seu email corporativo.');
                        return;
                    }
                    isLoading.value = true;

                    // Integração REAL com o backend
                    google.script.run.withSuccessHandler(res => {
                        isLoading.value = false;
                        alert(res.message);
                        currentView.value = 'login';
                    }).withFailureHandler(err => {
                        isLoading.value = false;
                        alert("Erro: " + err.message);
                    }).requestPasswordReset(authForm.value.email);
                };

                const fetchUserData = () => {
                    if (!authForm.value.id) return;
                    isLoading.value = true;
                    authForm.value.errorMessage = '';
                    authForm.value.name = '';
                    authForm.value.email = '';

                    google.script.run.withSuccessHandler(res => {
                        isLoading.value = false;
                        authForm.value.name = res.nome;
                        authForm.value.email = res.email;
                    }).withFailureHandler(err => {
                        isLoading.value = false;
                        authForm.value.errorMessage = err.message;
                    }).fetchUserByID(authForm.value.id);
                };

                const handleRegister = () => {
                    if (!authForm.value.id || !authForm.value.name) return;
                    isLoading.value = true;
                    google.script.run.withSuccessHandler(res => {
                        isLoading.value = false;
                        alert(res.message);
                        currentView.value = 'login';
                        // Reset form
                        authForm.value = { id: '', email: '', password: '', name: '', newPassword: '', confirmPassword: '', errorMessage: '' };
                    }).withFailureHandler(err => {
                        isLoading.value = false;
                        alert(err.message);
                    }).requestAccess(authForm.value.id, authForm.value.name, authForm.value.email);
                };

                const handleChangePassword = () => {
                    if (authForm.value.newPassword !== authForm.value.confirmPassword) {
                        authForm.value.errorMessage = "As senhas não conferem.";
                        return;
                    }
                    if (authForm.value.newPassword.length < 6) {
                        authForm.value.errorMessage = "A senha deve ter no mínimo 6 caracteres.";
                        return;
                    }
                    isLoading.value = true;
                    google.script.run.withSuccessHandler(res => {
                        isLoading.value = false;
                        alert(res.message);
                        initApp();
                    }).withFailureHandler(err => {
                        isLoading.value = false;
                        authForm.value.errorMessage = err.message;
                    }).changePassword(userEmail.value, authForm.value.newPassword, true);
                };

                const initiateChangePassword = () => {
                    authForm.value.newPassword = '';
                    authForm.value.confirmPassword = '';
                    authForm.value.errorMessage = '';
                    currentView.value = 'change_password';
                };

                const initApp = () => {
                    currentView.value = 'app';
                    google.script.run.withSuccessHandler(l => filiais.value = l).getFiliaisList();
                    google.script.run.withSuccessHandler(l => analystList.value = l).getAnalystsList();
                };

                const logout = () => {
                    userEmail.value = '';
                    currentView.value = 'login';
                    authForm.value = { id: '', email: '', password: '', name: '', newPassword: '', confirmPassword: '', errorMessage: '' };
                };

                // --- APP METHODS ---
                const performSearch = () => {
                    // Validação: precisa de pelo menos um campo preenchido
                    if (!selectedFilial.value && !searchQuery.value) {
                        alert("Por favor, informe uma Filial ou um termo de busca.");
                        return;
                    }
                    loading.value = true;
                    searchResults.value = [];
                    google.script.run.withSuccessHandler(res => {
                        searchResults.value = res.map(u => ({ ...u, selected: false }));
                        loading.value = false;
                    }).withFailureHandler(e => {
                        alert(e.message);
                        loading.value = false;
                    }).searchUsersWeb(searchQuery.value, selectedFilial.value);
                };

                // Função para ordenar resultados de busca
                const sortResults = (column) => {
                    if (resultSortColumn.value === column) {
                        resultSortDirection.value = resultSortDirection.value === 'asc' ? 'desc' : 'asc';
                    } else {
                        resultSortColumn.value = column;
                        resultSortDirection.value = 'asc';
                    }
                };

                const confirmAndSend = () => {
                    isConfirmModalVisible.value = false;
                    const selected = searchResults.value.filter(u => u.selected);
                    submitting.value = true;
                    // Usa a filial do primeiro usuário selecionado se nenhuma filial foi selecionada no dropdown
                    const filialToUse = selectedFilial.value || (selected.length > 0 ? selected[0].filial : '');
                    const data = { users: selected, analyst: selectedAnalyst.value, requester: userEmail.value, filial: filialToUse };
                    lastRequestData.value = data;
                    google.script.run.withSuccessHandler(() => {
                        submitting.value = false;
                        isSuccessModalVisible.value = true;
                        searchResults.value = [];
                        selectedFilial.value = '';
                        searchQuery.value = '';
                        selectedAnalyst.value = '';
                    }).withFailureHandler(e => {
                        submitting.value = false;
                        alert("Erro: " + e.message);
                    }).submitResetQueue(data);
                };

                // --- MIRROR METHODS ---
                const fetchMirrorGroups = () => {
                    if (!mirrorForm.value.modelUser) return;
                    mirrorLoading.value = true;
                    mirrorGroups.value = [];
                    mirrorStatusMsg.value = 'Iniciando solicitação ao agente...';

                    google.script.run.withSuccessHandler(res => {
                        if (res.success) {
                            pollMirrorStatus(res.requestId);
                        } else {
                            mirrorLoading.value = false;
                            alert('Erro ao iniciar: ' + res.message);
                        }
                    }).withFailureHandler(e => {
                        mirrorLoading.value = false;
                        alert('Falha: ' + e.message);
                    }).submitMirrorRequest(mirrorForm.value.modelUser, userEmail.value);
                };

                const pollMirrorStatus = (reqId) => {
                    let attempts = 0;
                    const maxAttempts = 30; // 60 segundos (2s interval)

                    if (mirrorPollInterval.value) clearInterval(mirrorPollInterval.value);

                    mirrorPollInterval.value = setInterval(() => {
                        attempts++;
                        mirrorStatusMsg.value = `Aguardando resposta do servidor local... (${attempts}s)`;

                        google.script.run.withSuccessHandler(res => {
                            if (res.status === 'CONCLUIDO') {
                                clearInterval(mirrorPollInterval.value);
                                mirrorLoading.value = false;
                                mirrorStatusMsg.value = '';
                                mirrorGroups.value = res.groups.map(g => ({ name: g, selected: false }));
                            } else if (res.status === 'ERRO') {
                                clearInterval(mirrorPollInterval.value);
                                mirrorLoading.value = false;
                                mirrorStatusMsg.value = '';
                                alert('Erro retornado pelo agente: ' + res.message);
                            }
                            // Se PENDENTE, continua
                        }).withFailureHandler(e => {
                            // Falha de rede no polling, não para necessariamente, mas loga
                            console.log('Poll error', e);
                        }).checkMirrorStatus(reqId);

                        if (attempts >= maxAttempts) {
                            clearInterval(mirrorPollInterval.value);
                            mirrorLoading.value = false;
                            mirrorStatusMsg.value = '';
                            alert('Tempo limite excedido. O agente local não respondeu a tempo.');
                        }
                    }, 2000);
                };

                const selectAllGroups = (val) => {
                    mirrorGroups.value.forEach(g => g.selected = val);
                };

                const selectedGroupsCount = computed(() => mirrorGroups.value.filter(g => g.selected).length);

                const submitMirrorFinal = () => {
                    const selected = mirrorGroups.value.filter(g => g.selected).map(g => g.name);
                    alert(`Simulação: Solicitação enviada com sucesso para espelhar ${selected.length} grupos do usuário ${mirrorForm.value.modelUser}. \n\n(Backend call pending implementation based on user flow)`);

                    // Reset
                    mirrorGroups.value = [];
                    mirrorForm.value.modelUser = '';
                };


                const loadQueue = () => {
                    currentTab.value = 'queue';
                    queueLoading.value = true;
                    google.script.run.withSuccessHandler(res => {
                        queueData.value = res;
                        queueLoading.value = false;
                    }).withFailureHandler(e => queueLoading.value = false).getQueueWeb();
                };

                // --- DOWNLOAD CSV (Lógica Real) ---
                const downloadReceipt = () => {
                    // 1. Validar se tem dados
                    if (!lastRequestData.value || !lastRequestData.value.users) {
                        alert("Nenhum dado para exportar.");
                        return;
                    }

                    const request = lastRequestData.value;
                    const timestamp = new Date().toLocaleString('pt-BR');

                    // 2. Cabeçalho do CSV
                    let csvContent = "Data;Filial;Nome Colaborador;Usuario Rede;Email;Centro Custo;Analista Responsavel;Solicitante\n";

                    // 3. Iterar sobre os usuários e montar as linhas
                    request.users.forEach(user => {
                        const row = [
                            timestamp,
                            request.filial,
                            user.nome,
                            user.user_name,
                            user.email || "-",
                            user.centro_custo,
                            request.analyst,
                            request.requester
                        ].map(field => `"${String(field).replace(/"/g, '""')}"`).join(";"); // Escape de aspas e uso de ; para Excel BR

                        csvContent += row + "\n";
                    });

                    // 4. Criar o Blob com BOM para acentuação funcionar no Excel
                    const bom = "\uFEFF";
                    const blob = new Blob([bom + csvContent], { type: "text/csv;charset=utf-8;" });

                    // 5. Criar link invisível e clicar
                    const link = document.createElement("a");
                    const url = URL.createObjectURL(blob);
                    link.setAttribute("href", url);
                    link.setAttribute("download", `Comprovante_Reset_${Date.now()}.csv`);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                };

                // Helpers
                const toTitleCase = (str) => String(str).replace(/_/g, ' ').toLowerCase().split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');

                const formatDate = (d) => {
                    if (!d) return '-';
                    const dateObj = new Date(d);
                    if (isNaN(dateObj.getTime())) return String(d);
                    return dateObj.toLocaleString('pt-BR', {
                        day: '2-digit', month: '2-digit', year: 'numeric',
                        hour: '2-digit', minute: '2-digit'
                    });
                };

                const toggleAll = () => { const s = !allSelected.value; filteredResults.value.forEach(u => u.selected = s); };
                const openConfirmModal = () => isConfirmModalVisible.value = true;
                const resetForm = () => { isSuccessModalVisible.value = false; searchResults.value = []; currentTab.value = 'queue'; loadQueue(); };

                // Métodos de ordenação e paginação
                const sortQueue = (column) => {
                    if (sortColumn.value === column) {
                        sortDirection.value = sortDirection.value === 'asc' ? 'desc' : 'asc';
                    } else {
                        sortColumn.value = column;
                        sortDirection.value = 'desc';
                    }
                };

                const changePage = (page) => {
                    if (page >= 1 && page <= totalPages.value) {
                        currentPage.value = page;
                    }
                };

                // Computed
                const uniqueCostCenters = computed(() => [...new Set(searchResults.value.map(u => u.centro_custo))].sort());
                const filteredResults = computed(() => {
                    let results = !selectedCostCenter.value ? searchResults.value : searchResults.value.filter(u => u.centro_custo === selectedCostCenter.value);

                    // Ordenação dos resultados
                    return [...results].sort((a, b) => {
                        let aVal = a[resultSortColumn.value];
                        let bVal = b[resultSortColumn.value];

                        // Tratamento para strings (case-insensitive)
                        if (typeof aVal === 'string') aVal = aVal.toLowerCase();
                        if (typeof bVal === 'string') bVal = bVal.toLowerCase();

                        const direction = resultSortDirection.value === 'asc' ? 1 : -1;
                        if (aVal > bVal) return direction;
                        if (aVal < bVal) return -direction;
                        return 0;
                    });
                });
                const hasResults = computed(() => searchResults.value.length > 0);
                const selectedCount = computed(() => filteredResults.value.filter(u => u.selected).length);
                const allSelected = computed(() => filteredResults.value.length > 0 && filteredResults.value.every(u => u.selected));

                // Computed properties para filtros da fila
                const uniqueQueueFilials = computed(() => [...new Set(queueData.value.map(item => item.filial))].sort());
                const uniqueQueueAnalysts = computed(() => [...new Set(queueData.value.map(item => item.analista))].filter(a => a).sort());

                const filteredQueue = computed(() => {
                    let filtered = queueData.value;

                    // Filtro por filial
                    if (queueFilters.value.filial) {
                        filtered = filtered.filter(item => item.filial === queueFilters.value.filial);
                    }

                    // Filtro por status
                    if (queueFilters.value.status) {
                        filtered = filtered.filter(item => item.status === queueFilters.value.status);
                    }

                    // Filtro por analista
                    if (queueFilters.value.analista) {
                        filtered = filtered.filter(item => item.analista === queueFilters.value.analista);
                    }

                    // Busca por nome/usuário
                    if (queueFilters.value.search) {
                        const search = queueFilters.value.search.toLowerCase();
                        filtered = filtered.filter(item =>
                            (item.nome && item.nome.toLowerCase().includes(search)) ||
                            (item.user && item.user.toLowerCase().includes(search))
                        );
                    }

                    // Ordenação
                    filtered = [...filtered].sort((a, b) => {
                        let aVal = a[sortColumn.value];
                        let bVal = b[sortColumn.value];

                        // Tratamento especial para datas
                        if (sortColumn.value === 'data') {
                            aVal = new Date(aVal).getTime() || 0;
                            bVal = new Date(bVal).getTime() || 0;
                        }

                        const direction = sortDirection.value === 'asc' ? 1 : -1;
                        if (aVal > bVal) return direction;
                        if (aVal < bVal) return -direction;
                        return 0;
                    });

                    return filtered;
                });

                const paginatedQueue = computed(() => {
                    const start = (currentPage.value - 1) * itemsPerPage.value;
                    const end = start + itemsPerPage.value;
                    return filteredQueue.value.slice(start, end);
                });

                const totalPages = computed(() => Math.ceil(filteredQueue.value.length / itemsPerPage.value) || 1);

                return {
                    appLogo, // Expõe a logo para o template
                    currentView, authForm, isLoading, userEmail, userInitials, rememberMe,
                    handleLogin, handleRegister, handleChangePassword, handleForgotPassword, logout, initiateChangePassword, fetchUserData,
                    currentTab, filiais, analystList, selectedFilial, selectedAnalyst, searchQuery,
                    searchResults, loading, submitting, isConfirmModalVisible, isSuccessModalVisible,
                    queueData, queueLoading, performSearch, confirmAndSend, loadQueue,
                    selectedCostCenter, uniqueCostCenters, filteredResults, hasResults, selectedCount, allSelected,
                    toggleAll, openConfirmModal, resetForm, downloadReceipt, toTitleCase, formatDate,
                    // Ordenação dos resultados de busca
                    resultSortColumn, resultSortDirection, sortResults,
                    // Novos - Filtros e Paginação da Fila
                    queueFilters, currentPage, itemsPerPage, sortColumn, sortDirection,
                    uniqueQueueFilials, uniqueQueueAnalysts, filteredQueue, paginatedQueue, totalPages,
                    sortQueue, changePage
                };
            }
        }).mount('#app');
    </script>
</body>

</html>